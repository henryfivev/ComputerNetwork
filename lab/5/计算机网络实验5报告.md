# 计算机网络 · 实验5报告

20337251 伍建霖

## 1. 实验目的

理解链路聚合的配置及原理。

## 2. 实验内容

(1)完成实验教程第三章实验6-5的实验，回答实验提出的问题及实验思考。（P187）

(2)端口聚合和生成树都可以实现冗余链路，这两种方式有什么不同？

(3)你认为本实验能实现负载平衡吗？如果不能，请讨论原因并设计方法，进行实验验证。

## 3. 实验6-5

### 1. 连接网络拓扑，观察实验前的情况

​	先连接好网线，两台交换机之间暂时只连一根。在PC2上建立共享目录，授权给用户Administrator，并打开wireshark，打开io统计，显示流量。在PC1上打开"运行"，输入\\\192.168.10.20\myshare，将出现一个文件窗口。

<img src="D:\CodeField\TyporaPicture\微信图片_20220930145107.png" alt="微信图片_20220930145107" style="zoom:40%;" />

​	将准备好的文件拖入窗口，观察PC2中的wireshark情况。

<img src="D:\CodeField\TyporaPicture\微信图片_202209301451072.png" alt="微信图片_202209301451072" style="zoom:40%;" />

​																端口聚合前传输时间约为9秒

### 2.配置两台交换机

​	创建vlan，access和PC连接的端口。创建聚合端口，设置为trunk模式。

<img src="D:\CodeField\TyporaPicture\微信图片_202209301451073.png" alt="微信图片_202209301451073" style="zoom:40%;" />

### 3. 端口聚合后的情况

​	端口聚合后，传输速度并没有明显变化。

<img src="D:\CodeField\TyporaPicture\微信图片_202209301451078.png" alt="微信图片_202209301451078" style="zoom:40%;" />

​																右二为传输到一半拔掉网线的情况

<img src="D:\CodeField\TyporaPicture\微信图片_202209301451074.png" alt="微信图片_202209301451074" style="zoom:40%;" />

​															传输时抓包的情况

### 4. 找原因

​	实验出来的结果与我们预期不同，从网上找资料发现可能是以下原因：

1. 带宽出现瓶颈。由于PC和交换机之间仅1根连线。
2. 流量平衡模式不会将PC1向PC2的数据传输分流到两条线上。默认情况下两台交换机的流量平衡模式是源mac + 目的mac 。从PC1向PC2传输时，源mac和目的mac都是一样的，即使连上了两根线也只会用一根来传输。

### 5. 判断哪条线在传输

​	抓包看包中信息。

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510719.png" alt="微信图片_2022093014510719" style="zoom:40%;" />

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510720.png" alt="微信图片_2022093014510720" style="zoom:40%;" />

### 6. 动态备份

​	将网线拔掉后，并没有丢包的情况出现。

<img src="D:\CodeField\TyporaPicture\微信图片_202209301451075.png" alt="微信图片_202209301451075" style="zoom:33%;" />

<img src="D:\CodeField\TyporaPicture\微信图片_202209301451076.png" alt="微信图片_202209301451076" style="zoom:33%;" />

### 7. 查看聚合端口

<img src="D:\CodeField\TyporaPicture\微信图片_202209301451079.png" alt="微信图片_202209301451079" style="zoom:40%;" />

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510714.png" alt="微信图片_2022093014510714" style="zoom:40%;" />

### 8. 查看成员端口

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510711.png" alt="微信图片_2022093014510711" style="zoom:40%;" />

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510715.png" alt="微信图片_2022093014510715" style="zoom:40%;" />

### 9. 查看端口状态

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510712.png" alt="微信图片_2022093014510712" style="zoom:40%;" />

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510716.png" alt="微信图片_2022093014510716" style="zoom:40%;" />

### 10.查看成员端口速率

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510713.png" alt="微信图片_2022093014510713" style="zoom:40%;" />

<img src="D:\CodeField\TyporaPicture\微信图片_2022093014510717.png" alt="微信图片_2022093014510717" style="zoom:40%;" />

## 4. 实验思考

### 4台PC互ping情况

<img src="D:\CodeField\TyporaPicture\image-20221009231659122.png" alt="image-20221009231659122" style="zoom:80%;" />

### 如何验证流量平衡模式

<img src="D:\CodeField\TyporaPicture\image-20221009231441116.png" alt="image-20221009231441116" style="zoom:80%;" />

<img src="D:\CodeField\TyporaPicture\image-20221009231511538.png" alt="image-20221009231511538" style="zoom:80%;" />

### 什么时候分流

<img src="D:\CodeField\TyporaPicture\image-20221009231537645.png" alt="image-20221009231537645" style="zoom:80%;" />

<img src="D:\CodeField\TyporaPicture\image-20221009231554907.png" alt="image-20221009231554907" style="zoom:80%;" />

### 和生成树有什么不同

AP是把多个端口物理连接，聚合成一个逻辑链路。实现负载均衡，冗余链路。生成树协议仅提供冗余链路功能。

